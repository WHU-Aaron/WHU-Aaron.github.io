<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Telstra_Cybersecurity | h4m5t's Blog</title><meta name="author" content="h4m5t"><meta name="copyright" content="h4m5t"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Telstra Cybersecurity Job SimulationAbouthttps:&#x2F;&#x2F;www.theforage.com&#x2F;simulations&#x2F;telstra&#x2F;cybersecurity-cyyo GitHub repository: https:&#x2F;&#x2F;github.com&#x2F;h4m5t&#x2F;Telstra_Cybersecurity Telstra is Australia’s large">
<meta property="og:type" content="article">
<meta property="og:title" content="Telstra_Cybersecurity">
<meta property="og:url" content="http://h4m5t.github.io/2024/10/13/Telstra-Cybersecurity/index.html">
<meta property="og:site_name" content="h4m5t&#39;s Blog">
<meta property="og:description" content="Telstra Cybersecurity Job SimulationAbouthttps:&#x2F;&#x2F;www.theforage.com&#x2F;simulations&#x2F;telstra&#x2F;cybersecurity-cyyo GitHub repository: https:&#x2F;&#x2F;github.com&#x2F;h4m5t&#x2F;Telstra_Cybersecurity Telstra is Australia’s large">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://tt3.pages.dev/img/de/de_10.jpg">
<meta property="article:published_time" content="2024-10-13T09:23:23.000Z">
<meta property="article:modified_time" content="2024-10-16T10:32:40.000Z">
<meta property="article:author" content="h4m5t">
<meta property="article:tag" content="安全">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tt3.pages.dev/img/de/de_10.jpg"><link rel="shortcut icon" href="/img/icon-H.png"><link rel="canonical" href="http://h4m5t.github.io/2024/10/13/Telstra-Cybersecurity/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Telstra_Cybersecurity',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-10-16 18:32:40'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/background.css"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="h4m5t's Blog" type="application/atom+xml">
</head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "/img/loading.gif" data-lazy-src="/img/touxiang.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">87</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">33</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">13</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://tt3.pages.dev/img/de/de_10.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="h4m5t's Blog"><span class="site-name">h4m5t's Blog</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Telstra_Cybersecurity</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-10-13T09:23:23.000Z" title="发表于 2024-10-13 17:23:23">2024-10-13</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-10-16T10:32:40.000Z" title="更新于 2024-10-16 18:32:40">2024-10-16</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AE%89%E5%85%A8/">安全</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">2.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>16分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Telstra_Cybersecurity"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Telstra-Cybersecurity-Job-Simulation"><a href="#Telstra-Cybersecurity-Job-Simulation" class="headerlink" title="Telstra Cybersecurity Job Simulation"></a>Telstra Cybersecurity Job Simulation</h1><h2 id="About"><a href="#About" class="headerlink" title="About"></a>About</h2><p><a target="_blank" rel="noopener" href="https://www.theforage.com/simulations/telstra/cybersecurity-cyyo">https://www.theforage.com/simulations/telstra/cybersecurity-cyyo</a></p>
<p>GitHub repository: <a target="_blank" rel="noopener" href="https://github.com/h4m5t/Telstra_Cybersecurity">https://github.com/h4m5t/Telstra_Cybersecurity</a></p>
<p><strong>Telstra</strong> is Australia’s largest telecommunications company, offering services like mobile phones, internet, and data solutions to millions of customers nationwide. Known for its reliability and innovation, Telstra connects people and businesses, ensuring smooth and effective communication.</p>
<p>The <strong>Telstra Cybersecurity Job Simulation Project</strong> is a training program designed to replicate real-world cybersecurity challenges. Participants work through tasks such as detecting threats, responding to incidents, collaborating with different teams, and implementing technical solutions to protect digital systems. This simulation helps individuals build the skills needed to defend against cyber attacks and keep Telstra’s services secure.</p>
<p>In the dynamic realm of cybersecurity, organizations must remain vigilant and responsive to emerging threats to safeguard their infrastructure and services. This blog post presents a detailed case study of how Telstra’s Security Operations Centre (SOC) effectively responded to a <strong>Spring4Shell (CVE-2022-22965)</strong> malware attack targeting the <strong>NBN Connection service</strong>. We will walk through the entire incident response process, encompassing initial threat triage, inter-team communication, technical mitigation using Python-based firewall rules, troubleshooting, and a post-incident analysis.</p>
<hr>
<h2 id="Task-1-Initial-Threat-Triage-and-Notification"><a href="#Task-1-Initial-Threat-Triage-and-Notification" class="headerlink" title="Task 1: Initial Threat Triage and Notification"></a><strong>Task 1: Initial Threat Triage and Notification</strong></h2><h3 id="Incident-Identification-and-Severity-Assessment"><a href="#Incident-Identification-and-Severity-Assessment" class="headerlink" title="Incident Identification and Severity Assessment"></a><strong>Incident Identification and Severity Assessment</strong></h3><p>On <strong>March 20th, 2024, at 14:20 UTC</strong>, the SOC detected unusual activity targeting the <strong>NBN Connection service (nbn.external.network)</strong>, which operates on <strong>Spring Framework 5.3.0</strong>. The attack manifested through multiple malicious POST requests to the <code>/tomcatwar.jsp</code> endpoint, indicating an exploitation attempt of the <strong>Spring4Shell</strong> vulnerability.</p>
<h3 id="Affected-Infrastructure-and-Prioritization"><a href="#Affected-Infrastructure-and-Prioritization" class="headerlink" title="Affected Infrastructure and Prioritization"></a><strong>Affected Infrastructure and Prioritization</strong></h3><p>An analysis of firewall logs revealed that the <strong>NBN Connection service</strong> was under direct attack. Given its critical role in providing high-speed internet connectivity, the incident was classified as <strong>P1 - Critical</strong>. Other services, including <strong>Mobile Tower Connection</strong>, <strong>Home &amp; Business Lines</strong>, and <strong>ADSL Connect</strong>, were evaluated and found to be unaffected based on the current logs. Nonetheless, continuous monitoring was recommended to ensure comprehensive security.</p>
<h3 id="Notification-of-the-Respective-Team"><a href="#Notification-of-the-Respective-Team" class="headerlink" title="Notification of the Respective Team"></a><strong>Notification of the Respective Team</strong></h3><p>Prompt communication was essential to coordinate an effective response. An urgent email was drafted and sent to the <strong>NBN Team</strong>, alerting them of the ongoing attack and the necessity to initiate immediate incident response measures.</p>
<p><strong>Email to NBN Team:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">From: Telstra Security Operations  </span><br><span class="line">To: NBN Team (nbn@email)  </span><br><span class="line">Subject: Urgent: Malware Attack Impacting NBN Connection Service</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line">Body:</span><br><span class="line"></span><br><span class="line">Hello NBN Team,</span><br><span class="line"></span><br><span class="line">At **14:20 on March 20, 2024**, a malware attack targeting the **NBN Connection service** running on the **Spring Framework** was detected, resulting in service disruption and impaired functionality. This incident has been assessed as **P1 - Critical** and requires the immediate initiation of incident response measures to restore services and prevent further impact.</span><br><span class="line"></span><br><span class="line">Please review the relevant logs promptly and take the necessary mitigation actions. If you need assistance or have any questions, feel free to contact us.</span><br><span class="line"></span><br><span class="line">Kind regards,  </span><br><span class="line">Telstra Security Operations</span><br></pre></td></tr></table></figure>

<p>This communication ensured that the <strong>NBN Team</strong> was promptly informed, enabling them to take swift action to mitigate the threat.</p>
<hr>
<h2 id="Task-2-Collaborating-with-the-Networks-Team-to-Mitigate-the-Attack"><a href="#Task-2-Collaborating-with-the-Networks-Team-to-Mitigate-the-Attack" class="headerlink" title="Task 2: Collaborating with the Networks Team to Mitigate the Attack"></a><strong>Task 2: Collaborating with the Networks Team to Mitigate the Attack</strong></h2><h3 id="Analyzing-Firewall-Logs-and-Identifying-Attack-Patterns"><a href="#Analyzing-Firewall-Logs-and-Identifying-Attack-Patterns" class="headerlink" title="Analyzing Firewall Logs and Identifying Attack Patterns"></a><strong>Analyzing Firewall Logs and Identifying Attack Patterns</strong></h3><p>Upon identifying the attack, the SOC conducted a thorough analysis of the firewall logs. The logs indicated that the attack originated from multiple IP addresses within the AU region, utilizing specific malicious payloads designed to exploit the Spring4Shell vulnerability. The attack pattern involved POST requests to the <code>/tomcatwar.jsp</code> endpoint with parameters like <code>class.module.classLoader.resources.context.parent.pipeline.first.pattern</code> and others.</p>
<h3 id="Drafting-an-Email-to-the-Networks-Team"><a href="#Drafting-an-Email-to-the-Networks-Team" class="headerlink" title="Drafting an Email to the Networks Team"></a><strong>Drafting an Email to the Networks Team</strong></h3><p>To address the distributed nature of the attack without blocking individual IP addresses, the SOC collaborated with the <strong>Networks Team</strong> to implement a firewall rule that filters incoming traffic based on the identified malicious request characteristics.</p>
<p><strong>Email to Networks Team:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">From: Telstra Security Operations  </span><br><span class="line">To: Networks Team (networks@email)  </span><br><span class="line">Subject: Create Firewall Rule to Mitigate Spring4Shell Attack</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line">Body:</span><br><span class="line"></span><br><span class="line">Hello Networks Team,</span><br><span class="line"></span><br><span class="line">We would like to request the creation of a firewall rule and provide you with more information about the ongoing attack.</span><br><span class="line"></span><br><span class="line">**Type of Attack:**</span><br><span class="line">Our analysis of the firewall logs indicates a Spring4Shell (CVE-2022-22965) malware attack targeting the **NBN Connection service (nbn.external.network)**. The attack involves multiple POST requests to `/tomcatwar.jsp` with malicious payloads designed to exploit the Spring Framework vulnerability.</span><br><span class="line"></span><br><span class="line">**Characteristics to Block:**</span><br><span class="line">- **Request Path:** `/tomcatwar.jsp`</span><br><span class="line">- **HTTP Method:** `POST`</span><br><span class="line">- **Specific Payload Patterns:** Requests containing parameters such as `class.module.classLoader.resources.context.parent.pipeline.first.pattern` and related malicious payloads.</span><br><span class="line"></span><br><span class="line">**Request:**</span><br><span class="line">Please implement a firewall rule to block incoming POST requests to the `/tomcatwar.jsp` endpoint and inspect for the presence of the aforementioned malicious payload patterns in the request data. This should help mitigate the distributed nature of the attack by targeting the specific exploit characteristics rather than individual IP addresses.</span><br><span class="line"></span><br><span class="line">**Additional Information:**</span><br><span class="line">The attack has been distributed across multiple IP addresses within the AU region. Blocking the specific request patterns will provide a more effective mitigation strategy. Attached is a proof of concept payload that demonstrates how the attacker scripts this attack, which may aid in refining the firewall rules.</span><br><span class="line"></span><br><span class="line">For any questions or issues, don’t hesitate to reach out to us.</span><br><span class="line"></span><br><span class="line">Kind regards,  </span><br><span class="line">Telstra Security Operations</span><br></pre></td></tr></table></figure>

<p>This email provided the <strong>Networks Team</strong> with the necessary details to develop targeted firewall rules, enhancing the organization’s defensive measures against the attack.</p>
<hr>
<h2 id="Task-3-Implementing-Firewall-Rules-with-Python"><a href="#Task-3-Implementing-Firewall-Rules-with-Python" class="headerlink" title="Task 3: Implementing Firewall Rules with Python"></a><strong>Task 3: Implementing Firewall Rules with Python</strong></h2><h3 id="Developing-a-Python-Based-Firewall-Rule"><a href="#Developing-a-Python-Based-Firewall-Rule" class="headerlink" title="Developing a Python-Based Firewall Rule"></a><strong>Developing a Python-Based Firewall Rule</strong></h3><p>To mitigate the attack effectively, a Python script was developed to implement a firewall rule that filters incoming traffic based on the identified malicious request characteristics. The goal was to block malicious POST requests to the <code>/tomcatwar.jsp</code> endpoint without relying on IP-based blocking, which is less effective against distributed attacks.</p>
<p><strong>Firewall Server Script (<code>firewall_server.py</code>):</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># firewall_server.py</span></span><br><span class="line"><span class="comment"># www.theforage.com - Telstra Cyber Task 3</span></span><br><span class="line"><span class="comment"># Firewall Server Handler</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> http.server <span class="keyword">import</span> BaseHTTPRequestHandler, HTTPServer</span><br><span class="line"><span class="keyword">import</span> urllib.parse</span><br><span class="line"></span><br><span class="line">host = <span class="string">&quot;localhost&quot;</span></span><br><span class="line">port = <span class="number">8000</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#########</span></span><br><span class="line"><span class="comment"># Handle the response here </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">block_request</span>(<span class="params">self</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Blocking malicious request from:&quot;</span>, self.client_address)</span><br><span class="line">    self.send_response(<span class="number">403</span>)</span><br><span class="line">    self.send_header(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;application/json&quot;</span>)</span><br><span class="line">    self.end_headers()</span><br><span class="line">    response = <span class="string">&#x27;&#123;&quot;message&quot;: &quot;403 Forbidden: Malicious request blocked.&quot;&#125;&#x27;</span></span><br><span class="line">    self.wfile.write(response.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">allow_request</span>(<span class="params">self</span>):</span><br><span class="line">    self.send_response(<span class="number">200</span>)</span><br><span class="line">    self.send_header(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;application/json&quot;</span>)</span><br><span class="line">    self.end_headers()</span><br><span class="line">    response = <span class="string">&#x27;&#123;&quot;message&quot;: &quot;200 OK&quot;&#125;&#x27;</span></span><br><span class="line">    self.wfile.write(response.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#########</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Define malicious parameters associated with Spring4Shell vulnerability</span></span><br><span class="line">MALICIOUS_PARAMS = [</span><br><span class="line">    <span class="string">&#x27;class.module.classLoader.resources.context.parent.pipeline.first.pattern&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;class.module.classLoader.resources.context.parent.pipeline.first.suffix&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;class.module.classLoader.resources.context.parent.pipeline.first.directory&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;class.module.classLoader.resources.context.parent.pipeline.first.prefix&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;class.module.classLoader.resources.context.parent.pipeline.first.fileDateFormat&#x27;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ServerHandler</span>(<span class="title class_ inherited__">BaseHTTPRequestHandler</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">do_GET</span>(<span class="params">self</span>):</span><br><span class="line">        allow_request(self)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">do_POST</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># Check if the request path is the targeted endpoint</span></span><br><span class="line">        <span class="keyword">if</span> self.path == <span class="string">&#x27;/tomcatwar.jsp&#x27;</span>:</span><br><span class="line">            <span class="comment"># Retrieve and decode the request body</span></span><br><span class="line">            content_length = <span class="built_in">int</span>(self.headers.get(<span class="string">&#x27;Content-Length&#x27;</span>, <span class="number">0</span>))</span><br><span class="line">            body = self.rfile.read(content_length).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">            params = urllib.parse.parse_qs(body)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># Check for the presence of any malicious parameters</span></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">any</span>(param <span class="keyword">in</span> params <span class="keyword">for</span> param <span class="keyword">in</span> MALICIOUS_PARAMS):</span><br><span class="line">                block_request(self)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                allow_request(self)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># For all other POST requests, allow them</span></span><br><span class="line">            allow_request(self)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">log_message</span>(<span class="params">self, <span class="built_in">format</span>, *args</span>):</span><br><span class="line">        <span class="comment"># Override to suppress default logging</span></span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:        </span><br><span class="line">    server = HTTPServer((host, port), ServerHandler)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] Firewall Server&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] HTTP Web Server running on: %s:%s&quot;</span> % (host, port))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        server.serve_forever()</span><br><span class="line">    <span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    server.server_close()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] Server terminated. Exiting...&quot;</span>)</span><br><span class="line">    exit(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Testing-the-Firewall-Rule"><a href="#Testing-the-Firewall-Rule" class="headerlink" title="Testing the Firewall Rule"></a><strong>Testing the Firewall Rule</strong></h3><p>A complementary script, <code>test_requests.py</code>, was utilized to simulate both malicious and benign requests to ensure the firewall rule functioned as intended.</p>
<p><strong>Test Requester Script (<code>test_requests.py</code>):</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Test Requester.py</span></span><br><span class="line"><span class="comment"># www.theforage.com - Telstra Cyber Task 3</span></span><br><span class="line"><span class="comment"># Test Requester</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> http.client</span><br><span class="line"></span><br><span class="line">host = <span class="string">&quot;localhost&quot;</span></span><br><span class="line">port = <span class="number">8000</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    target = <span class="string">f&quot;<span class="subst">&#123;host&#125;</span>:<span class="subst">&#123;port&#125;</span>&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[+] Beginning test requests to: <span class="subst">&#123;target&#125;</span>&quot;</span>)</span><br><span class="line">    successful_responses = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        payload = (</span><br><span class="line">            <span class="string">&quot;class.module.classLoader.resources.context.parent.pipeline.first.pattern=%25%7Bc2%7Di%20if(&quot;</span></span><br><span class="line">            <span class="string">&quot;%22j%22.equals(request.getParameter(%22pwd%22)))%7B%20java.io.InputStream%20in%20%3D%20%25%7Bc1%7Di.&quot;</span></span><br><span class="line">            <span class="string">&quot;getRuntime().exec(request.getParameter(%22cmd%22)).getInputStream()%3B%20int%20a%20%3D%20-1%3B%20byte%5B%5D%20b%20&quot;</span></span><br><span class="line">            <span class="string">&quot;%3D%20new%20byte%5B2048%5D%3B%20while((a%3Din.read(b))!%3D-1)%7B%20out.println(new%20String(b))%3B%20%7D%20%7D%20%&quot;</span></span><br><span class="line">            <span class="string">&quot;7Bsuffix%7Di&amp;class.module.classLoader.resources.context.parent.pipeline.first.suffix=.jsp&amp;class.module.&quot;</span></span><br><span class="line">            <span class="string">&quot;classLoader.resources.context.parent.pipeline.first.directory=webapps/ROOT&amp;class.module.classLoader.&quot;</span></span><br><span class="line">            <span class="string">&quot;resources.context.parent.pipeline.first.prefix=tomcatwar&amp;class.module.classLoader.resources.context.parent.&quot;</span></span><br><span class="line">            <span class="string">&quot;pipeline.first.fileDateFormat=&quot;</span></span><br><span class="line">        )</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[<span class="subst">&#123;x + <span class="number">1</span>&#125;</span>/5]: Making test request to <span class="subst">&#123;target&#125;</span> with payload: <span class="subst">&#123;payload&#125;</span>&quot;</span>)</span><br><span class="line">        conn = http.client.HTTPConnection(target)</span><br><span class="line"></span><br><span class="line">        conn.request(<span class="string">&#x27;POST&#x27;</span>, <span class="string">&#x27;/tomcatwar.jsp&#x27;</span>, payload,  &#123;</span><br><span class="line">            <span class="string">&quot;suffix&quot;</span>: <span class="string">&quot;%&gt;//&quot;</span>,</span><br><span class="line">            <span class="string">&quot;c1&quot;</span>: <span class="string">&quot;Runtime&quot;</span>,</span><br><span class="line">            <span class="string">&quot;c2&quot;</span>: <span class="string">&quot;&lt;%&quot;</span>,</span><br><span class="line">            <span class="string">&quot;DNT&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">            <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,</span><br><span class="line">        &#125;)</span><br><span class="line">        response = conn.getresponse()</span><br><span class="line">        status_code = response.status</span><br><span class="line">        <span class="keyword">if</span> status_code == <span class="number">200</span>:</span><br><span class="line">            successful_responses += <span class="number">1</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Response status code: <span class="subst">&#123;status_code&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;=============&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] Test completed.&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[+] Successful responses: <span class="subst">&#123;successful_responses&#125;</span>/5&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<h3 id="Troubleshooting-Addressing-Port-Conflicts"><a href="#Troubleshooting-Addressing-Port-Conflicts" class="headerlink" title="Troubleshooting: Addressing Port Conflicts"></a><strong>Troubleshooting: Addressing Port Conflicts</strong></h3><p>During the deployment of the <code>firewall_server.py</code> script, an error was encountered:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">OSError: [Errno 48] Address already in use</span><br></pre></td></tr></table></figure>

<p>This indicated that port <strong>8000</strong> was occupied by another process, preventing the firewall server from binding to it. The following steps were undertaken to resolve the issue:</p>
<ol>
<li><p><strong>Identifying the Occupying Process:</strong></p>
<p>Using the <code>lsof</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsof -i :8000</span><br></pre></td></tr></table></figure>

<p>This command revealed the Process ID (PID) of the application using port 8000.</p>
</li>
<li><p><strong>Terminating the Conflicting Process:</strong></p>
<p>The identified process was terminated using the <code>kill</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">kill</span> -9 &lt;PID&gt;</span><br></pre></td></tr></table></figure>

<p>Replace <code>&lt;PID&gt;</code> with the actual Process ID obtained from the previous step.</p>
</li>
<li><p><strong>Verifying Port Availability:</strong></p>
<p>Ensuring that port 8000 was free by rerunning the <code>lsof</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsof -i :8000</span><br></pre></td></tr></table></figure>

<p>No output indicates that the port is now free.</p>
</li>
<li><p><strong>Restarting the Firewall Server:</strong></p>
<p>After freeing up the port, the <code>firewall_server.py</code> script was successfully executed:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 firewall_server.py</span><br></pre></td></tr></table></figure>

<p>The server started without issues, indicating that it was listening on the designated port.</p>
</li>
</ol>
<h3 id="Alternative-Solution-Changing-the-Server-Port"><a href="#Alternative-Solution-Changing-the-Server-Port" class="headerlink" title="Alternative Solution: Changing the Server Port"></a><strong>Alternative Solution: Changing the Server Port</strong></h3><p>If port 8000 remains consistently in use, an alternative approach involves changing the server to listen on a different port (e.g., 8080). This requires updating both the <code>firewall_server.py</code> and <code>test_requests.py</code> scripts to reflect the new port number.</p>
<ol>
<li><p><strong>Edit <code>firewall_server.py</code>:</strong></p>
<p>Modify the port variable:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">host = <span class="string">&quot;localhost&quot;</span></span><br><span class="line">port = <span class="number">8080</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Edit <code>test_requests.py</code>:</strong></p>
<p>Update the port number accordingly:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">host = <span class="string">&quot;localhost&quot;</span></span><br><span class="line">port = <span class="number">8080</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Run the Modified Server:</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 firewall_server.py</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Run the Test Requester:</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 test_requests.py</span><br></pre></td></tr></table></figure>

<p>This ensures that the firewall rule is correctly applied on the new port.</p>
</li>
</ol>
<hr>
<h2 id="Task-4-Incident-Postmortem-and-Lessons-Learned"><a href="#Task-4-Incident-Postmortem-and-Lessons-Learned" class="headerlink" title="Task 4: Incident Postmortem and Lessons Learned"></a><strong>Task 4: Incident Postmortem and Lessons Learned</strong></h2><h3 id="Incident-Postmortem-Spring4Shell-Malware-Attack-on-NBN-Connection-Service"><a href="#Incident-Postmortem-Spring4Shell-Malware-Attack-on-NBN-Connection-Service" class="headerlink" title="Incident Postmortem: Spring4Shell Malware Attack on NBN Connection Service"></a><strong>Incident Postmortem: Spring4Shell Malware Attack on NBN Connection Service</strong></h3><hr>
<h3 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a><strong>Summary</strong></h3><p>On <strong>March 20th, 2024, at 14:20 UTC</strong>, Telstra’s Security Operations Centre (SOC) detected a <strong>P1 - Critical</strong> malware attack targeting the <strong>NBN Connection service (nbn.external.network)</strong>, operating on <strong>Spring Framework 5.3.0</strong>. The attack involved multiple malicious POST requests to the <code>/tomcatwar.jsp</code> endpoint, exploiting the <strong>Spring4Shell (CVE-2022-22965)</strong> vulnerability. The incident was identified through firewall log analysis and was successfully mitigated <strong>two hours</strong> after detection by implementing a targeted firewall rule. Key teams involved in the response included the <strong>Security Operations Centre</strong> and the <strong>NBN Team</strong>.</p>
<hr>
<h3 id="Impact"><a href="#Impact" class="headerlink" title="Impact"></a><strong>Impact</strong></h3><ul>
<li><strong>Service Disruption:</strong> The NBN Connection service experienced significant downtime, impairing high-speed internet connectivity for customers relying on this infrastructure.</li>
<li><strong>Operational Impairment:</strong> Critical services dependent on the NBN Connection, such as remote communications and business operations, were temporarily affected.</li>
<li><strong>Potential Data Exposure:</strong> Although no data breaches were confirmed, the nature of the attack posed a risk of unauthorized command execution and potential data exfiltration.</li>
</ul>
<hr>
<h3 id="Detection"><a href="#Detection" class="headerlink" title="Detection"></a><strong>Detection</strong></h3><p>The incident was discovered through routine monitoring of firewall logs by the SOC. Analysis revealed a pattern of multiple POST requests to the <code>/tomcatwar.jsp</code> endpoint originating from several IP addresses within the AU region. These requests contained specific malicious payloads characteristic of the Spring4Shell vulnerability, including parameters like <code>class.module.classLoader.resources.context.parent.pipeline.first.pattern</code> and others designed to execute remote commands.</p>
<hr>
<h3 id="Root-Cause"><a href="#Root-Cause" class="headerlink" title="Root Cause"></a><strong>Root Cause</strong></h3><p>The root cause of the incident was the exploitation of the <strong>Spring4Shell (CVE-2022-22965)</strong> vulnerability within the <strong>Spring Framework 5.3.0</strong> used by the <strong>NBN Connection service</strong>. Attackers crafted malicious POST requests to the <code>/tomcatwar.jsp</code> endpoint, embedding payloads that leveraged this vulnerability to execute arbitrary commands on the server, leading to service disruption and impaired functionality.</p>
<hr>
<h3 id="Resolution"><a href="#Resolution" class="headerlink" title="Resolution"></a><strong>Resolution</strong></h3><p>To mitigate the attack, the SOC collaborated with the Networks Team to implement a targeted firewall rule using a Python-based HTTP server (<code>firewall_server.py</code>). The rule specifically blocked incoming POST requests to the <code>/tomcatwar.jsp</code> endpoint that contained the identified malicious parameters. This measure effectively halted the ongoing attack within two hours of its initiation, restoring the NBN Connection service to operational status and preventing further unauthorized access.</p>
<hr>
<h3 id="Action-Items"><a href="#Action-Items" class="headerlink" title="Action Items"></a><strong>Action Items</strong></h3><ol>
<li><p><strong>Immediate Actions:</strong></p>
<ul>
<li><strong>Firewall Rule Implementation:</strong> Successfully deployed a Python-scripted firewall rule to block malicious POST requests targeting the <code>/tomcatwar.jsp</code> endpoint.</li>
<li><strong>Service Restoration:</strong> Coordinated with the Networks Team to ensure the NBN Connection service was promptly restored to normal operations.</li>
</ul>
</li>
<li><p><strong>Short-Term Actions:</strong></p>
<ul>
<li><strong>Vulnerability Patching:</strong> Upgrade the Spring Framework to the latest version to eliminate the exploited Spring4Shell vulnerability.</li>
<li><strong>Enhanced Monitoring:</strong> Increase the frequency and depth of firewall log reviews to detect similar or new attack patterns more swiftly.</li>
<li><strong>Incident Documentation:</strong> Complete detailed documentation of the incident for future reference and compliance purposes.</li>
</ul>
</li>
<li><p><strong>Long-Term Actions:</strong></p>
<ul>
<li><strong>Security Training:</strong> Conduct training sessions for the SOC and relevant teams on identifying and responding to similar vulnerabilities and attack vectors.</li>
<li><strong>Comprehensive Security Audit:</strong> Perform a thorough security audit of all critical services to identify and remediate potential vulnerabilities.</li>
<li><strong>Automation of Response Mechanisms:</strong> Develop automated scripts and tools to detect and mitigate such attacks in real-time, reducing response times.</li>
<li><strong>Collaboration with Development Teams:</strong> Work closely with development teams to ensure secure coding practices are followed, particularly when using frameworks like Spring.</li>
</ul>
</li>
<li><p><strong>Future Prevention:</strong></p>
<ul>
<li><strong>Regular Updates and Patching:</strong> Establish a routine schedule for updating and patching all software frameworks and dependencies to minimize vulnerability exposure.</li>
<li><strong>Advanced Threat Detection Systems:</strong> Invest in more sophisticated threat detection and prevention systems that can identify and block complex attack patterns.</li>
<li><strong>Incident Response Drills:</strong> Conduct regular incident response drills to ensure all teams are prepared to handle similar attacks efficiently.</li>
</ul>
</li>
</ol>
<hr>
<h3 id="Lessons-Learned"><a href="#Lessons-Learned" class="headerlink" title="Lessons Learned"></a><strong>Lessons Learned</strong></h3><ul>
<li><strong>Proactive Monitoring:</strong> Continuous and proactive monitoring of firewall logs is essential in the early detection of potential threats.</li>
<li><strong>Collaborative Response:</strong> Effective communication and collaboration between the SOC and infrastructure teams are critical in swiftly mitigating attacks.</li>
<li><strong>Automation and Scripting:</strong> Utilizing scripting languages like Python for developing automated firewall rules can significantly enhance response times and accuracy.</li>
<li><strong>Regular Patching:</strong> Keeping all software frameworks and dependencies up-to-date is vital in preventing exploitation of known vulnerabilities.</li>
<li><strong>Comprehensive Documentation:</strong> Maintaining detailed incident postmortems aids in future governance, risk management, and compliance efforts while educating the team on handling similar incidents.</li>
</ul>
<hr>
<h3 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a><strong>Conclusion</strong></h3><p>This incident underscored the importance of robust monitoring, swift response mechanisms, and collaborative efforts in combating sophisticated malware attacks. By implementing targeted firewall rules and adhering to best practices in incident response, Telstra effectively mitigated the Spring4Shell attack, ensuring the continuity of its critical services and reinforcing its commitment to cybersecurity excellence.</p>
<hr>
<p><strong>Prepared by:</strong><br>Telstra Security Operations<br><strong>Date:</strong> April 27, 2024</p>
<h2 id="Certificate"><a href="#Certificate" class="headerlink" title="Certificate"></a>Certificate</h2><p>Online： <a target="_blank" rel="noopener" href="https://forage-uploads-prod.s3.amazonaws.com/completion-certificates/Telstra%20AU/RNhbu8QnDzthwynEf_Telstra_5TM4hAgTK2E48m74F_1728568521860_completion_certificate.pdf">https://forage-uploads-prod.s3.amazonaws.com/completion-certificates/Telstra%20AU/RNhbu8QnDzthwynEf_Telstra_5TM4hAgTK2E48m74F_1728568521860_completion_certificate.pdf</a></p>
<p>PDF：<a href="certificate.pdf">certificate.pdf</a> </p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://h4m5t.github.io">h4m5t</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://h4m5t.github.io/2024/10/13/Telstra-Cybersecurity/">http://h4m5t.github.io/2024/10/13/Telstra-Cybersecurity/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://h4m5t.github.io" target="_blank">h4m5t's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%AE%89%E5%85%A8/">安全</a></div><div class="post_share"><div class="social-share" data-image="https://tt3.pages.dev/img/de/de_10.jpg" data-sites="wechat,qq,twitter"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/10/15/buffer-overflow/" title="Buffer Overflow Attack"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://tt3.pages.dev/img/de/de_2.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Buffer Overflow Attack</div></div></a></div><div class="next-post pull-right"><a href="/2024/10/12/apps/" title="移动应用的静态动态分析"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/HCLonely/hclonely.github.io/img/Butterfly/014.webp" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">移动应用的静态动态分析</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2021/01/26/Web%E5%AE%89%E5%85%A8/" title="web安全学习路线"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/HCLonely/hclonely.github.io/img/Butterfly/014.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-01-27</div><div class="title">web安全学习路线</div></div></a></div><div><a href="/2021/01/27/%E5%90%8C%E6%BA%90%E7%AD%96%E7%95%A5/" title="浏览器的同源策略与跨站请求伪造（CSRF）"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://tt3.pages.dev/img/de/de_1.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-01-28</div><div class="title">浏览器的同源策略与跨站请求伪造（CSRF）</div></div></a></div><div><a href="/2021/03/18/TCPIP/" title="TCP&#x2F;IP协议脆弱性分析"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://tt3.pages.dev/img/de/de_3.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-03-19</div><div class="title">TCP&#x2F;IP协议脆弱性分析</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "/img/loading.gif" data-lazy-src="/img/touxiang.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">h4m5t</div><div class="author-info__description">人生得意需尽欢</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">87</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">33</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">13</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/h4m5t"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/h4m5t" target="_blank" title="GitHub"><i class="fab fa-github"></i></a><a class="social-icon" href="https://www.linkedin.com/in/yuduo-ding-943824202" target="_blank" title="LinkedIn"><i class="fab fa-linkedin"></i></a><a class="social-icon" href="https://twitter.com/h4m5t" target="_blank" title="Twitter"><i class="fab fa-x-twitter"></i></a><a class="social-icon" href="https://www.zhihu.com/people/h4m5t" target="_blank" title="ZhiHu"><i class="fab fa-zhihu"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fas fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">Welcome! <br> 安全技术交流群753267126 <br> 网安考研交流群244768497 <br></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Telstra-Cybersecurity-Job-Simulation"><span class="toc-number">1.</span> <span class="toc-text">Telstra Cybersecurity Job Simulation</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#About"><span class="toc-number">1.1.</span> <span class="toc-text">About</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Task-1-Initial-Threat-Triage-and-Notification"><span class="toc-number">1.2.</span> <span class="toc-text">Task 1: Initial Threat Triage and Notification</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Incident-Identification-and-Severity-Assessment"><span class="toc-number">1.2.1.</span> <span class="toc-text">Incident Identification and Severity Assessment</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Affected-Infrastructure-and-Prioritization"><span class="toc-number">1.2.2.</span> <span class="toc-text">Affected Infrastructure and Prioritization</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Notification-of-the-Respective-Team"><span class="toc-number">1.2.3.</span> <span class="toc-text">Notification of the Respective Team</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Task-2-Collaborating-with-the-Networks-Team-to-Mitigate-the-Attack"><span class="toc-number">1.3.</span> <span class="toc-text">Task 2: Collaborating with the Networks Team to Mitigate the Attack</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Analyzing-Firewall-Logs-and-Identifying-Attack-Patterns"><span class="toc-number">1.3.1.</span> <span class="toc-text">Analyzing Firewall Logs and Identifying Attack Patterns</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Drafting-an-Email-to-the-Networks-Team"><span class="toc-number">1.3.2.</span> <span class="toc-text">Drafting an Email to the Networks Team</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Task-3-Implementing-Firewall-Rules-with-Python"><span class="toc-number">1.4.</span> <span class="toc-text">Task 3: Implementing Firewall Rules with Python</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Developing-a-Python-Based-Firewall-Rule"><span class="toc-number">1.4.1.</span> <span class="toc-text">Developing a Python-Based Firewall Rule</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Testing-the-Firewall-Rule"><span class="toc-number">1.4.2.</span> <span class="toc-text">Testing the Firewall Rule</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Troubleshooting-Addressing-Port-Conflicts"><span class="toc-number">1.4.3.</span> <span class="toc-text">Troubleshooting: Addressing Port Conflicts</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Alternative-Solution-Changing-the-Server-Port"><span class="toc-number">1.4.4.</span> <span class="toc-text">Alternative Solution: Changing the Server Port</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Task-4-Incident-Postmortem-and-Lessons-Learned"><span class="toc-number">1.5.</span> <span class="toc-text">Task 4: Incident Postmortem and Lessons Learned</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Incident-Postmortem-Spring4Shell-Malware-Attack-on-NBN-Connection-Service"><span class="toc-number">1.5.1.</span> <span class="toc-text">Incident Postmortem: Spring4Shell Malware Attack on NBN Connection Service</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Summary"><span class="toc-number">1.5.2.</span> <span class="toc-text">Summary</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Impact"><span class="toc-number">1.5.3.</span> <span class="toc-text">Impact</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Detection"><span class="toc-number">1.5.4.</span> <span class="toc-text">Detection</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Root-Cause"><span class="toc-number">1.5.5.</span> <span class="toc-text">Root Cause</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Resolution"><span class="toc-number">1.5.6.</span> <span class="toc-text">Resolution</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Action-Items"><span class="toc-number">1.5.7.</span> <span class="toc-text">Action Items</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Lessons-Learned"><span class="toc-number">1.5.8.</span> <span class="toc-text">Lessons Learned</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Conclusion"><span class="toc-number">1.5.9.</span> <span class="toc-text">Conclusion</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Certificate"><span class="toc-number">1.6.</span> <span class="toc-text">Certificate</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/10/15/buffer-overflow/" title="Buffer Overflow Attack">Buffer Overflow Attack</a><time datetime="2024-10-15T15:55:23.000Z" title="发表于 2024-10-15 23:55:23">2024-10-15</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/10/13/Telstra-Cybersecurity/" title="Telstra_Cybersecurity">Telstra_Cybersecurity</a><time datetime="2024-10-13T09:23:23.000Z" title="发表于 2024-10-13 17:23:23">2024-10-13</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/10/12/apps/" title="移动应用的静态动态分析">移动应用的静态动态分析</a><time datetime="2024-10-12T12:03:10.000Z" title="发表于 2024-10-12 20:03:10">2024-10-12</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/10/07/USYD-CTF/" title="USYD_CTF">USYD_CTF</a><time datetime="2024-10-07T16:35:10.000Z" title="发表于 2024-10-08 00:35:10">2024-10-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/09/30/HTB-Invalidated/" title="HTB_Invalidated">HTB_Invalidated</a><time datetime="2024-09-30T06:00:01.000Z" title="发表于 2024-09-30 14:00:01">2024-09-30</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://tt3.pages.dev/img/de/de_10.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By h4m5t</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>(() => {
  const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaid.length === 0) return
  const runMermaid = () => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    Array.from($mermaid).forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
      const mermaidID = 'mermaid-' + index
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)

      const renderV10 = () => {
        renderFn.then(({svg}) => {
          mermaidSrc.insertAdjacentHTML('afterend', svg)
        })
      }

      const renderV9 = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      typeof renderFn === 'string' ? renderV9(renderFn) : renderV10()
    })
  }

  const loadMermaid = () => {
    window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
  }

  btf.addGlobalFn('themeChange', runMermaid, 'mermaid')

  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>